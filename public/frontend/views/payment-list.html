<div class="page">

    <!-- PAGE HEADER -->
    <div class="page-header d-flex justify-content-between align-items-center">
        <div>
            <h4>Payments</h4>
            <p class="page-subtitle">Received & Paid payments</p>
        </div>

        <div class="page-actions">
            <!-- <a href="#!/dashboard" class="btn btn-outline-secondary me-2">
                ← Back
            </a> -->
            <a href="#!/payments" class="btn btn-primary">
                + Add Payment
            </a>
        </div>
    </div>

    <!-- FILTERS -->
    <div class="card mb-3">
        <div class="row g-2">

            <div class="col-md-4">
                <input class="form-control"
                       placeholder="Search party"
                       ng-model="search">
            </div>

            <div class="col-md-3">
                <select class="form-control"
                        ng-model="type">
                    <option value="">All</option>
                    <option value="in">Received</option>
                    <option value="out">Paid</option>
                </select>
            </div>

        </div>
    </div>

    <!-- PAYMENT TABLE -->
    <div class="card">
        <table class="table munim-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Party</th>
                    <th>Type</th>
                    <th class="text-end">Amount</th>
                    <th class="text-end">Action</th>
                </tr>
            </thead>

            <tbody>
                <tr ng-repeat="p in payments">
                    <td>{{ p.date | date:'dd-MM-yyyy' }}</td>
                    <td>{{ p.party.name }}</td>
                    <td>
                        <span class="badge"
                              ng-class="{
                                'bg-success': p.type=='in',
                                'bg-warning': p.type=='out'
                              }">
                            {{ p.type == 'in' ? 'Received' : 'Paid' }}
                        </span>
                    </td>
                    <td class="text-end">
                        ₹ {{ p.amount | number:2 }}
                    </td>
                    <td class="text-end">
                        <button class="btn btn-sm btn-outline-primary"
                                ng-click="openEdit(p)">
                            Edit
                        </button>

                        <button class="btn btn-sm btn-outline-danger"
                                ng-click="delete(p.id)">
                            Delete
                        </button>
                    </td>
                </tr>

                <tr ng-if="payments.length === 0">
                    <td colspan="5" class="text-center text-muted">
                        No payments found
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

</div>

<!-- EDIT PAYMENT MODAL -->
<div class="modal fade" id="paymentModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">Edit Payment</h5>
                <button type="button" class="btn-close"
                        data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">

                <label>Amount</label>
                <input class="form-control mb-2"
                       type="number"
                       ng-model="editPayment.amount">
                <label >Date</label>
                    <input type="date"
                        class="form-control mb-2"
                        ng-model="editPayment.date"
                        required>
                <label>Mode</label>
                <input class="form-control mb-2"
                       ng-model="editPayment.mode">

                <label>Note</label>
                <textarea class="form-control"
                          ng-model="editPayment.note"></textarea>

            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary"
                        data-bs-dismiss="modal">
                    Cancel
                </button>

                <button class="btn btn-primary"
                        ng-click="update()">
                    Update
                </button>
            </div>

        </div>
    </div>
</div>
